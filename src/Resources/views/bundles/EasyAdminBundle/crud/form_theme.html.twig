{# @var ea \EasyCorp\Bundle\EasyAdminBundle\Context\AdminContext #}
{% extends '@!EasyAdmin/crud/form_theme.html.twig' %}

{# Widgets #}

{% block mwt_admin_attachment_widget -%}
    {# TODO: This is a temporary implementation... #}

    <div class="input-group">
        {{ form_widget(form, {attr: {
            class: 'mwt-attachment-field form-control',
            'data-api-url': form.vars.api_url,
            'data-csrf-token': csrf_token(form.vars.api_token_id),
        }}) }}

        {% if form.vars.valid and form.vars.data is not empty %}
            <button type="button" class="btn btn-secondary" onclick="javascript:document.getElementById('{{ form.vars.id }}__metadata').classList.toggle('visually-hidden')"><i class="fas fa-list" style="padding-right: 2px;"></i></button>

            <a class="btn btn-primary" style="height: 28px; margin-top: 1px;" href="{{ attachment_public_url(form.vars.data) }}" target="_blank">Preview <i class="fas fa-external-link-alt"></i></a>
        {% endif %}
    </div>

    {% if form.vars.valid and form.vars.data is not empty %}
        <div id="{{ form.vars.id }}__metadata" class="mt-3 visually-hidden">{{ dump(form.vars.data.metadata) }}</div>
    {% endif %}

    <div class="mwt-upload-widget mt-3">
        <div>
            <label for="{{ form.vars.id }}__file" class="required">File</label>
            <input id="{{ form.vars.id }}__file" type="file">
        </div>
        <div>
            <label for="{{ form.vars.id }}__context">Context</label>
            <input type="text" id="{{ form.vars.id }}__context">
        </div>

        <button class="btn btn-primary" id="{{ form.vars.id }}__upload_button">Upload</button>
    </div>
{%- endblock mwt_admin_attachment_widget %}

{% block mwt_admin_editorjs_widget -%}
    {# TODO: This is a temporary implementation... #}

        {{ form_widget(form, {
            value: value|json_encode,
            type: 'hidden',
            attr: {
                class: 'mwt-editorjs-field',
                'data-tools-options': tools_options|json_encode,
            }
        }) }}

        <div id="{{ id }}__editor" class="form-control mwt-widget-wrapper mwt-editorjs-wrapper"></div>
{%- endblock mwt_admin_editorjs_widget %}
